# 画像分類

## keras_nn.py: Neural networkを用いてMNIST手書き数字を10クラス分類

実行方法
```bash
python keras_nn.py
```

### コード説明：データの準備
MNISTデータは手書き数字とラベル（0から9の数値）の組が70000組格納されたデータベースです．手書き数字は28x28画素のグレースケール画像です．今回は70000のうち60000枚をトレーニング用，10000枚をテスト用に使います．
トレーニング用及びテスト用の手書き数字とラベルを読み込みます．Neural Networkはデータを1次元ベクトルとして入力する必要があるため，28x28画素の手書き数字は1x784の1次元ベクトルに変換します．そして手書き数字データは0から1の実数をとるように正規化します．ラベルはone-hot vector表現に変換します．

### コード説明：ネットワークの定義と学習
コードのmodel = Sequential()以降でネットワークを定義します．今回は以下のネットワークを使用します．
![Network structure of neural network](https://github.com/modafone/dmed/blob/master/classification/images/network_nn.png)
compileでトレーニングの設定を行い，fitでトレーニングを行います．トレーニング中はトレーニング用データを用いてネットワークの学習を行います．

### コード説明：推定の実行
model.predict_classesでテスト用データを学習済みネットワークに与え，推定ラベル値を得ます．accuracy_scoreに推定ラベル値と正解ラベル値を与え，正解率を算出しています．さらに，混同行列を算出する関数confusion_matrixを用いて混合行列を算出し，どのクラスが正解・誤りが多いか確認できます．


## keras_cnn.py: Convolutional neural networkを用いてMNIST手書き数字を10クラス分類

実行方法
```bash
python keras_cnn.py
```

### コード説明：データの準備
MNISTデータは手書き数字とラベル（0から9の数値）の組が70000組格納されたデータベースです．手書き数字は28x28画素のグレースケール画像です．今回は70000のうち60000枚をトレーニング用，10000枚をテスト用に使います．
トレーニング用及びテスト用の手書き数字とラベルを読み込みます．Neural Networkの場合と異なり，Convolutional Neural Networkは2次元配列状の画像データを直接的に入力することが可能です．そのため手書き数字は28x28画素の画像としての形式のまま使用します．手書き数字をネットワークに入力する上で，トレーニング用，テスト用それぞれの手書き数字の集合を（画像数，28，28，1）というサイズの4次元配列に格納します．最後の次元の1は画像の色チャンネル数で，カラー画像であれば3になります．手書き数字データは0から1の実数をとるように正規化します．ラベルはone-hot vector表現に変換します．

### コード説明：ネットワークの定義と学習
コードのmodel = Sequential()以降でネットワークを定義します．今回は以下のネットワークを使用します．
![Network structure of neural network](https://github.com/modafone/dmed/blob/master/classification/images/network_cnn.png)
compileでトレーニングの設定を行い，fitでトレーニングを行います．トレーニング中はトレーニング用データを用いてネットワークの学習を行います．

### コード説明：推定の実行
model.predict_classesでテスト用データを学習済みネットワークに与え，推定ラベル値を得ます．accuracy_scoreに推定ラベル値と正解ラベル値を与え，正解率を算出しています．さらに，混合行列を算出する関数confusion_matrixを用いて混同行列を算出し，どのクラスが正解・誤りが多いか確認できます．
